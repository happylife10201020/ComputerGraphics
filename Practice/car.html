<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Three.js Car Movement</title>
</head>
<body style="margin:0; overflow:hidden;">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script>
    // ğŸš— ê¸°ë³¸ ì„¸íŒ…
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
    camera.position.set(0, 60, 120);
    camera.lookAt(0, 0, 0);

    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    const light = new THREE.DirectionalLight(0xffffff, 1);
    light.position.set(100, 200, 100);
    scene.add(light);

    const ground = new THREE.Mesh(
      new THREE.PlaneGeometry(500, 500),
      new THREE.MeshLambertMaterial({ color: 0x808080 })
    );
    ground.rotation.x = -Math.PI / 2;
    scene.add(ground);

    // ğŸš˜ 1. ë°”í€´ í•˜ë‚˜ ìƒì„±
    function createWheel(radius = 4, width = 2, color = 0x333333) {
      const geometry = new THREE.CylinderGeometry(radius, radius, width, 32);
      const material = new THREE.MeshStandardMaterial({ color });
      const wheel = new THREE.Mesh(geometry, material);
      wheel.rotation.z = Math.PI / 2; // ëˆ•íˆê¸°
      return wheel;
    }

    // ğŸš˜ 2. ë°”í€´ 4ê°œ ìƒì„±
    function createWheels() {
      const positions = [
        [10, 4, 12], [-10, 4, 12], // ì•
        [10, 4, -12], [-10, 4, -12] // ë’¤
      ];
      return positions.map(pos => {
        const w = createWheel();
        w.position.set(...pos);
        scene.add(w);
        return w;
      });
    }

    // ğŸš˜ 3. ì°¨ì²´ ìƒì„±
    function createCarBody() {
      const body = new THREE.Mesh(
        new THREE.BoxGeometry(25, 8, 40),
        new THREE.MeshStandardMaterial({ color: 0xff0000 })
      );
      body.position.y = 8;
      scene.add(body);

      const cabin = new THREE.Mesh(
        new THREE.BoxGeometry(18, 6, 20),
        new THREE.MeshStandardMaterial({ color: 0x0000ff })
      );
      cabin.position.set(0, 13, -3);
      scene.add(cabin);

      return { body, cabin };
    }

    // ğŸš˜ 4. ìë™ì°¨ ì „ì²´ ìƒì„±
    function createCar() {
      const wheels = createWheels();
      const { body, cabin } = createCarBody();
      const car = new THREE.Group();
      wheels.forEach(w => car.add(w));
      car.add(body);
      car.add(cabin);
      scene.add(car);
      return car;
    }

    const car = createCar();
    car.position.set(0, 0, 0);

    // ğŸš¦ 5. ì´ë™ ì œì–´ ë³€ìˆ˜
    let speed = 0;
    let turnSpeed = 0;
    const maxSpeed = 1.5;
    const accel = 0.05;
    const turnRate = 0.03;
    const friction = 0.98;

    const keys = {};
    window.addEventListener("keydown", e => keys[e.key.toLowerCase()] = true);
    window.addEventListener("keyup", e => keys[e.key.toLowerCase()] = false);

    // ğŸš€ 6. ì• ë‹ˆë©”ì´ì…˜ ë£¨í”„
    function animate() {
      // ----- ì…ë ¥ ì²˜ë¦¬ -----
      if (keys["w"]) speed = Math.min(speed + accel, maxSpeed);    // ì „ì§„
      if (keys["s"]) speed = Math.max(speed - accel, -maxSpeed);   // í›„ì§„
      if (keys["a"]) turnSpeed =  turnRate;                        // ì¢ŒíšŒì „
      else if (keys["d"]) turnSpeed = -turnRate;                   // ìš°íšŒì „
      else turnSpeed = 0;

      // ----- íšŒì „ ë° ì´ë™ -----
      car.rotation.y += turnSpeed;                                 // ì°¨ì²´ íšŒì „
      car.position.x += Math.sin(car.rotation.y) * speed;          // ë°©í–¥ ê¸°ë°˜ ì´ë™
      car.position.z += Math.cos(car.rotation.y) * speed * -1;

      // ----- ê°ì† (ë§ˆì°° íš¨ê³¼) -----
      speed *= friction;

      renderer.render(scene, camera);
      requestAnimationFrame(animate);
    }

    animate();
  </script>
</body>
</html>
